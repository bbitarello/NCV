# mappability tracks
MAP=/mnt/sequencedb/PopGen/cesare/hg19/mappability_tracks/wgEncodeCrgMapabilityAlign50mer_100.bed.gz

# Tandem Repeat Finder (TRF) or soimpleRepeat
TRF=/mnt/sequencedb/PopGen/cesare/hg19/simpleRepeat.bed

# Segmental duplications (ask Aida and/or others)

SDs=/mnt/sequencedb/PopGen/joao/Exome_Project/Results/Filtering/SDs/Human/Human_MAPPED_COORDINATES.bed

cat <( sed 's/chr//' ${SDs})  ${TRF} | sort -nk1,1 -nk2,2 | mergeBed -i  > TRF.SDs.bed

subtractBed -a ${MAP} -b TRF.SDs.bed > Map50_100.TRF.SDs.bed

cp Map50_100.TRF.SDs.bed /mnt/scratch/cee/
BED=/mnt/scratch/cee/Map50_100.TRF.SDs.bed
 
for CHROM in {1..22}; do
ACfile=/mnt/scratch/cee/1000G/allele_freq/LcovEx_50inds/chr${CHROM}/AC_13pops.tsv.gz
ACfileOUT=/mnt/scratch/cee/1000G/allele_freq/LcovEx_50inds/chr${CHROM}/AC_13pops.Map50_100.TRF.SDs.tsv
intersectBed -a <(zcat ${ACfile}) -b ${BED} > ${ACfileOUT}
bgzip -f ${ACfileOUT}
tabix -p vcf ${ACfileOUT}.gz
echo $CHROM
done


